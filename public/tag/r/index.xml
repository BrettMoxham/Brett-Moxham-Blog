<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>R | Brett C. Moxham</title>
    <link>/tag/r/</link>
      <atom:link href="/tag/r/index.xml" rel="self" type="application/rss+xml" />
    <description>R</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language><lastBuildDate>Fri, 16 Oct 2020 00:00:00 +0000</lastBuildDate>
    <image>
      <url>/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png</url>
      <title>R</title>
      <link>/tag/r/</link>
    </image>
    
    <item>
      <title>Customer Analysis Part 2</title>
      <link>/post/customer-analysis-part-2/</link>
      <pubDate>Fri, 16 Oct 2020 00:00:00 +0000</pubDate>
      <guid>/post/customer-analysis-part-2/</guid>
      <description>

&lt;div id=&#34;TOC&#34;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#part-1&#34;&gt;Part 1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#libaries-and-data&#34;&gt;Libaries and Data&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#rfm-analysis&#34;&gt;RFM Analysis&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#clustering&#34;&gt;Clustering&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#set-up&#34;&gt;Set Up&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#final-model&#34;&gt;Final Model&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#cluster-profiles&#34;&gt;Cluster Profiles&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#wrap-up&#34;&gt;Wrap Up&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;

&lt;div id=&#34;part-1&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Part 1&lt;/h1&gt;
&lt;p&gt;This is a continuation of a previous post. If you haven’t already, give it a read &lt;a href=&#34;https://brettmoxham.netlify.app/post/customer-analysis-eda/&#34;&gt;here&lt;/a&gt;. We take an exploratory data analysis approach with a data set from a retailer/wholesaler from the UK. In that post we looked at dollar drivers, unit drivers and where sales were originating from. This will examine clusters of customers, trying to identify which customers are similar.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;libaries-and-data&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Libaries and Data&lt;/h1&gt;
&lt;p&gt;Let’s load in our data and our libraries. We can find our &lt;code&gt;sales&lt;/code&gt; csv in my &lt;a href=&#34;https://github.com/BrettMoxham/Random-Projects/blob/master/Consumer%20Data%20-%20EDA/sales.csv&#34;&gt;github&lt;/a&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(tidyverse)
library(tidymodels)
library(lubridate)
library(rfm)

sales &amp;lt;- read_csv(&amp;quot;https://raw.githubusercontent.com/BrettMoxham/Random-Projects/master/Consumer%20Data%20-%20EDA/sales.csv&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;rfm-analysis&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;RFM Analysis&lt;/h1&gt;
&lt;p&gt;RFM analysis, is a great way to compare and contrast customers. RFM stands for &lt;strong&gt;Recency Frequency Monetary&lt;/strong&gt;. We want to see how recently a customer has purchased from us, how often they do so, and how much they spend. Those 3 metrics can then be used to cluster our customers together into groups. We can then extrapolate the groupings into a customer profile, and we can use these customer profiles to help group other customers into those profiles as well. These profiles can be used with things such as target marketing, so that we can tailor our marketing approach to each individual customer. Let’s run some RFM analysis on our sales data. However, we still need to clean our data even further. We are going to use the &lt;code&gt;rfm&lt;/code&gt; package for our analysis. We need:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The number of orders per customer&lt;/li&gt;
&lt;li&gt;Number of days since last transaction&lt;/li&gt;
&lt;li&gt;Date of the analysis (for this we will use January 1st 2012, as this data covers 2010/2011)&lt;/li&gt;
&lt;li&gt;Total revenue by customer&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sales_rfm &amp;lt;- sales %&amp;gt;% 
  group_by(customer_id) %&amp;gt;% 
  summarise(
    num_trans = n_distinct(invoice_no),
    num_days = as.Date(&amp;quot;2012/01/01&amp;quot;) - max(date),
    total_revenue = sum(item_value)
            ) %&amp;gt;% 
  ungroup() %&amp;gt;% 
  filter(!is.na(customer_id))

rfm_table &amp;lt;- rfm_table_customer(sales_rfm, 
                   customer_id = &amp;quot;customer_id&amp;quot;,
                   n_transactions = &amp;quot;num_trans&amp;quot;,
                   recency_days = &amp;quot;num_days&amp;quot;,
                   total_revenue = &amp;quot;total_revenue&amp;quot;,
                   analysis_date = as.Date(&amp;quot;2012/01/01&amp;quot;)
                   )
knitr::kable(head(rfm_table$rfm))&lt;/code&gt;&lt;/pre&gt;
&lt;table style=&#34;width:100%;&#34;&gt;
&lt;colgroup&gt;
&lt;col width=&#34;11%&#34; /&gt;
&lt;col width=&#34;12%&#34; /&gt;
&lt;col width=&#34;16%&#34; /&gt;
&lt;col width=&#34;7%&#34; /&gt;
&lt;col width=&#34;13%&#34; /&gt;
&lt;col width=&#34;15%&#34; /&gt;
&lt;col width=&#34;14%&#34; /&gt;
&lt;col width=&#34;9%&#34; /&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;right&#34;&gt;customer_id&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;recency_days&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;transaction_count&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;amount&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;recency_score&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;frequency_score&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;monetary_score&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;rfm_score&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12346&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;348 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;121&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12347&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;25 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4310.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;545&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12348&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;98 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1797.24&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;234&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12349&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;41 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1757.55&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;414&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12350&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;333 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;334.40&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;112&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12352&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;59 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1545.41&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;354&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;We now have a table outlining our RFM data. Each customer is graded on a 1 - 5 scale, with 1 being least valuable and 5 being most. A customer who ranks as a 5,5,5 is our most valuable customer. They spend the most, are buying the most frequently and have bought recently. On the other side, a 1,1,1 customer is not valuable at all, and we should not waste time pursuing them for future sales. They buy small amounts infrequently and haven’t bought recently at all.&lt;/p&gt;
&lt;p&gt;Let’s visualize our data here firstly.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;rfm_fm_plot(rfm_table)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-10-16-customer-analysis-part-2.en_files/figure-html/unnamed-chunk-3-1.png&#34; width=&#34;672&#34; /&gt;
Our customers are clustered quite close together for the majority of customers. However we see a few who either spend quite a bit more than others, or who are sending in invoices quite often.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;clustering&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Clustering&lt;/h1&gt;
&lt;p&gt;We can use the K-Means algorithm to group our customers. K means is an unsupervised algorithm that takes &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; random centroids (these &lt;strong&gt;k&lt;/strong&gt; points are in our data points already, and chosen at random). The centroids then define a cluster where in the remaining data points are assigned to their nearest centroid (1 and only 1 centroid) by euclidean distance. The centroids are then shifted such that the total euclidean distance is reduced for each cluster (some data points may change clusters in this shifting). This process repeats until there is no shift in centroids that will reduce the euclidean distance of their clusters anymore. The final shift will produce the final centroids and in turn the final clusters for the data.&lt;/p&gt;
&lt;div id=&#34;set-up&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Set Up&lt;/h2&gt;
&lt;p&gt;Firstly, we need to get our rfm scores only. Our current &lt;code&gt;rfm_table&lt;/code&gt; has a bunch of extra data that we won’t use in our K-means algorithm.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;rfm_scores &amp;lt;- rfm_table$rfm[,(5:7)]

knitr::kable(head(rfm_scores))&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;right&#34;&gt;recency_score&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;frequency_score&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;monetary_score&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Now we a data set with only our recency, frequency and monetary scores. Each is still representative of our customers, but we no longer need the &lt;code&gt;customer_id&lt;/code&gt; value as we are only trying to get a sense of what each customer is. We can now run our K-means algorithm. Let’s arbitrarily use a &lt;strong&gt;k&lt;/strong&gt; value equal to 5. This will create 5 clusters.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;k_means_basic &amp;lt;- kmeans(rfm_scores, centers = 5)
head(k_means_basic$cluster)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 5 3 1 4 5 3&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We’ve run our K-means algorithm and assigned each customer to a cluster. We’ve arbitrarily chosen 5 as our number of clusters, however this may not be the best number to chose. We need a way to determine the best number of clusters. We can do this by using a function, and iterating over a vector of &lt;strong&gt;k&lt;/strong&gt; values.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;k &amp;lt;- as.vector(2:20)
set.seed(123)

kmeans_function &amp;lt;- function(k){
  
  cluster &amp;lt;- kmeans(rfm_scores, centers = k)
  return(cluster$tot.withinss)
}

cluster_withinness &amp;lt;- sapply(k, kmeans_function)

cluster_df &amp;lt;- data.frame(k, cluster_withinness)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;What we’ve done here is iterate through bunch of different &lt;strong&gt;k&lt;/strong&gt; values and taken the sum of squares for each &lt;strong&gt;k&lt;/strong&gt; value. We can graph our &lt;strong&gt;k&lt;/strong&gt; values and our sum of squares to create an elbow plot. Where our elbow plot “bends” is our best fit value for &lt;strong&gt;k&lt;/strong&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(cluster_df, aes(x = k, y = cluster_withinness)) +
  geom_point()+
  geom_line()+
  labs(
    title = &amp;quot;Which K Should We Use?&amp;quot;,
    x = &amp;quot;K&amp;quot;,
    y = &amp;quot;Sum of Squares&amp;quot;
  )+
  theme_light()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-10-16-customer-analysis-part-2.en_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;final-model&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Final Model&lt;/h2&gt;
&lt;p&gt;It looks like this we have a elbow somewhere around 5 to 7. Let’s use 7 as our &lt;strong&gt;k&lt;/strong&gt; value. We can now re-run our K-means algorithm to view our clusters and their centers.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;set.seed(123)
k_means_final &amp;lt;- kmeans(rfm_scores, centers = 7)

k_means_final$centers&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   recency_score frequency_score monetary_score
## 1      4.471088        3.382653       3.700680
## 2      2.348162        3.725338       4.214700
## 3      1.473177        1.588721       2.698762
## 4      4.503277        4.847969       4.874181
## 5      4.385463        1.621145       1.894273
## 6      2.736726        2.803097       2.550885
## 7      1.846154        1.159587       1.216992&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;These are our clusters, with their cluster center values. Looking at the values, it seems like cluster 2 represents our best customers. They buy a lot, frequently and have bought most recently. Cluster 1 represents our worst customers. They don’t buy a often, haven’t bought lots, and the last time they bought was a while ago. Examining the remaining clusters we can build a profile of our clusters. For instance looking at cluster 6. They are a customer who’ve bought something for the first time recently, but just a small amount. Let’s see if we can identify a profile for our clusters.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;cluster-profiles&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Cluster Profiles&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;k_means_final$centers&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   recency_score frequency_score monetary_score
## 1      4.471088        3.382653       3.700680
## 2      2.348162        3.725338       4.214700
## 3      1.473177        1.588721       2.698762
## 4      4.503277        4.847969       4.874181
## 5      4.385463        1.621145       1.894273
## 6      2.736726        2.803097       2.550885
## 7      1.846154        1.159587       1.216992&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Cluster Profiles:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;These customers buy somewhat frequently, however haven’t in some time. It may be worth to send them a contact to see if they are worth following up on.&lt;/li&gt;
&lt;li&gt;Our best customers - They a lot, frequently and have done so recently. Keep these guys happy!&lt;/li&gt;
&lt;li&gt;They buy a relatively large amount, in frequently and have done so recently. No real need to send them any incentives, as they are unlikely to buy right away.&lt;/li&gt;
&lt;li&gt;These are our 2nd best customers, They buy a lot, and frequently. It may be worth exploring incentives to see if you can convert them to the ranks of best customers.&lt;/li&gt;
&lt;li&gt;These are in the range of our 2nd best customers. They buy a lot and frequently, but haven’t bought in a while. It may be that they are moving away from our services. It would be worth while to touch base with these customers so that we can try and salvage them as customers.&lt;/li&gt;
&lt;li&gt;These are new customers. Ones who have bought recently but only a small amount and most likely for the first time. Targeted marketing may be worth while to help convert them to regular customers.&lt;/li&gt;
&lt;li&gt;These are dead customers. They don’t buy much, and haven’t done recently. We should move on from any marketing to these customers, as they are unlikely to be valuable to us.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Let’s add our cluster designations back into our original data, so that we can see which customer fits into which cluster.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;customer_clusters &amp;lt;- augment(k_means_final, rfm_table$rfm) %&amp;gt;% 
  select(customer_id, .cluster)

sales_clustered &amp;lt;- sales_rfm %&amp;gt;% 
  left_join(customer_clusters, by = &amp;quot;customer_id&amp;quot;)
head(sales_clustered) %&amp;gt;%
  knitr::kable()&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;right&#34;&gt;customer_id&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;num_trans&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;num_days&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;total_revenue&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;.cluster&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12346&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;348 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.00&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12347&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;25 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4310.00&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12348&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;98 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1797.24&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12349&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;41 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1757.55&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12350&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;333 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;334.40&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12352&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;59 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1545.41&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Now we can identify which customer belongs to which cluster. We can now identify which customers can use some marketing and which we can stop focusing on. For instance, customer 12346 is in cluster 7 and is a dead customer. If we are marketing towards them, we could allocate those dollars to other customers and see a larger return. Let’s identify our a few of our “new” customers. This would equate to cluster 6.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sales_clustered %&amp;gt;% 
  filter(.cluster == 6) %&amp;gt;% 
  head(15) %&amp;gt;% 
  knitr::kable()&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;right&#34;&gt;customer_id&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;num_trans&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;num_days&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;total_revenue&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;.cluster&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12371&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;67 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1887.96&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12379&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;104 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;850.29&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12394&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;86 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1272.48&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12403&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;72 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;409.70&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12413&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;89 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;694.15&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12422&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;118 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;803.56&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12434&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;107 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;765.19&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12452&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;39 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;428.57&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12458&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;94 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;947.40&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12468&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;166 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;724.04&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12492&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;86 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;263.21&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12493&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;188 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;416.79&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12498&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;44 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;403.70&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12527&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;104 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;348.71&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12552&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;61 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;437.82&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;As we can see, these customers have very few purchases and a relatively low total order value. But they also have bought recently. We can try some marketing towards these customers in order to convert them to a more valuable customer! Let’s take a look at our “faltering customers” in cluster 5.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sales_clustered %&amp;gt;% 
  filter(.cluster == 5) %&amp;gt;% 
  head(15) %&amp;gt;% 
  knitr::kable()&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;right&#34;&gt;customer_id&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;num_trans&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;num_days&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;total_revenue&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;.cluster&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12349&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;41 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1757.55&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12367&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;27 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;168.90&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12374&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;48 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;742.93&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12375&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;25 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;455.42&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12391&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;44 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;460.89&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12442&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;26 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;172.06&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12445&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;45 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;133.40&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12478&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;26 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;680.99&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12504&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;41 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;114.00&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12508&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;49 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;398.27&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12531&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;37 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;125.22&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12532&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;53 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;349.83&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12538&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;52 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;363.95&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12544&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;52 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;355.70&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;12558&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;24 days&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.00&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;We can see a stark difference between cluster 5 and 6. As we identified in our cluster portfolios, cluster 6 was our “new customers” and cluster 5 is our “almost 2nd best” customer. They are customers are who used to buy lots and frequently, how ever haven’t done so in a while. We can see this manifested when we view some of the customers who fall in this cluster. Customer 12352 has 11 separate transactions, however hasn’t bough in 59 days. Customer 12409 has 7 different transactions but hasn’t bought in 101 days! These customers are worth touching base with to see if we can re-ignite purchasing.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;wrap-up&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Wrap Up&lt;/h1&gt;
&lt;p&gt;We’ve run a combination of recency frequency monetary analysis and K-Means algorithms on our sales data. What we’ve worked out is a profile of our customers. We can use these profiles to better utilize our marketing efforts. For instance, if we identify a customer as one in cluster 7 of our profile, we would want to reduce or all out stop marketing towards them. More likely than not, that customer is dead weight. However if we identify a customer as being in cluster 5, we may want to touch base with them. These customers were once very good, however they have stop buying for one reason or another. We will, at least, want to monitor these customers in case they slip to a lower quality customer.&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Customer Analysis - EDA</title>
      <link>/post/customer-analysis-eda/</link>
      <pubDate>Sun, 27 Sep 2020 00:00:00 +0000</pubDate>
      <guid>/post/customer-analysis-eda/</guid>
      <description>


&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(tidyverse)
library(lubridate) #used to parse date and time in our data cleaning step.
library(gt)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;objective&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Objective&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;Taking the data set provided by the &lt;a href=&#34;https://archive.ics.uci.edu/ml/datasets/online+retail#&#34;&gt;UCI Machine Learning Repository&lt;/a&gt;, we want to take an exploratory data analysis approach to gain insights into this store’s customer.&lt;/strong&gt; This data set contains transactions occurring between 01/12/2010 and 09/12/2011 for a UK-based and registered non-store online retail.The company mainly sells unique all-occasion gifts. Many customers of the company are wholesalers.&lt;/p&gt;
&lt;p&gt;A few things that we want to look at:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Sales by day&lt;/li&gt;
&lt;li&gt;Unit drivers&lt;/li&gt;
&lt;li&gt;Dollar drivers&lt;/li&gt;
&lt;li&gt;Orders/order value by country&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;data&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Data&lt;/h1&gt;
&lt;p&gt;As stated above, we’ve taken data provided from the UCI Machine Learning Repository. You can find a link to the actual data &lt;a href=&#34;https://archive.ics.uci.edu/ml/machine-learning-databases/00352/&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;online_retail &amp;lt;-  readxl::read_xlsx(&amp;quot;C:/Users/Brett/Desktop/Github/Random Projects/Consumer Data - EDA/Online Retail.xlsx&amp;quot;) ##reads in our data

online_retail &amp;lt;- online_retail %&amp;gt;% ##converts character variables to factor
  mutate_if(is.character, as.factor) %&amp;gt;% 
  janitor::clean_names() ## cleans up variable names. &lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;data-cleaning&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Data Cleaning&lt;/h2&gt;
&lt;p&gt;Let’s take a quick first look at our data so we can see what we are dealing with.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;skimr::skim(online_retail)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-3&#34;&gt;Table 1: &lt;/span&gt;Data summary&lt;/caption&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Name&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;online_retail&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Number of rows&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;541909&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Number of columns&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;_______________________&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Column type frequency:&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;factor&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;numeric&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;POSIXct&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;________________________&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Group variables&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;None&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Variable type: factor&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;skim_variable&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_missing&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;complete_rate&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;ordered&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_unique&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;top_counts&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;invoice_no&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;FALSE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;25900&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;573: 1114, 581: 749, 581: 731, 580: 721&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;stock_code&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;FALSE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4070&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;851: 2313, 224: 2203, 850: 2159, 475: 1727&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;description&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1454&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;FALSE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4211&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;WHI: 2369, REG: 2200, JUM: 2159, PAR: 1727&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;country&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;FALSE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;38&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Uni: 495478, Ger: 9495, Fra: 8557, EIR: 8196&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Variable type: numeric&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;colgroup&gt;
&lt;col width=&#34;10%&#34; /&gt;
&lt;col width=&#34;7%&#34; /&gt;
&lt;col width=&#34;10%&#34; /&gt;
&lt;col width=&#34;6%&#34; /&gt;
&lt;col width=&#34;5%&#34; /&gt;
&lt;col width=&#34;7%&#34; /&gt;
&lt;col width=&#34;6%&#34; /&gt;
&lt;col width=&#34;6%&#34; /&gt;
&lt;col width=&#34;6%&#34; /&gt;
&lt;col width=&#34;4%&#34; /&gt;
&lt;col width=&#34;29%&#34; /&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;skim_variable&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_missing&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;complete_rate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;mean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;sd&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p0&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p25&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p50&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p75&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p100&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;hist&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;quantity&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.55&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;218.08&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-80995.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;80995&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▁▁▇▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;unit_price&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.61&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;96.76&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-11062.06&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.25&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.08&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.13&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;38970&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▁▇▁▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;customer_id&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;135080&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.75&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15287.69&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1713.60&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12346.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13953.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15152.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16791.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18287&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▇▇▇▇▇&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Variable type: POSIXct&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;colgroup&gt;
&lt;col width=&#34;13%&#34; /&gt;
&lt;col width=&#34;9%&#34; /&gt;
&lt;col width=&#34;13%&#34; /&gt;
&lt;col width=&#34;18%&#34; /&gt;
&lt;col width=&#34;18%&#34; /&gt;
&lt;col width=&#34;18%&#34; /&gt;
&lt;col width=&#34;8%&#34; /&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;skim_variable&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_missing&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;complete_rate&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;min&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;max&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;median&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_unique&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;invoice_date&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2010-12-01 08:26:00&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2011-12-09 12:50:00&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2011-07-19 17:17:00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23260&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;We have over 540,000 different orders, of which we have 8 different data points on each.
We have data on:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The invoice number&lt;/li&gt;
&lt;li&gt;The stock code&lt;/li&gt;
&lt;li&gt;The stock description&lt;/li&gt;
&lt;li&gt;Country of purchase&lt;/li&gt;
&lt;li&gt;Quantity purchased&lt;/li&gt;
&lt;li&gt;Unit price&lt;/li&gt;
&lt;li&gt;Anonymized customer ID number&lt;/li&gt;
&lt;li&gt;Invoice date&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Most of our data points are fully complete. However we are missing some item descriptions, quite a few (25%) of our customer ID’s. These two are not able to be imputed, and we can chalk up to data quality issues. There isn’t much that we can do to remedy this. Notice too, that we don’t have a total value of individual purchases, or a total dollar value of each invoice. These are important factors to consider. We can pretty simply create these variables. Let’s also add in some date variables that we may want to look at. Finally, when we look at our &lt;code&gt;quantity&lt;/code&gt; tab, we see that the lowest value is -80995. Without being to verify, we must assume that this means that stock was returned to the store. It could be a data quality issue, but we have no way of knowing.&lt;/p&gt;
&lt;p&gt;Now that we have looked at our data, it is time to add in some extra variables that will help in our analysis. We will create a new data frame and call it &lt;code&gt;sales&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sales &amp;lt;- online_retail %&amp;gt;%
  mutate(item_value = unit_price*quantity) %&amp;gt;% 
  group_by(invoice_no) %&amp;gt;% 
  mutate(invoice_total_value = sum(item_value)) %&amp;gt;% 
  ungroup() %&amp;gt;% 
  mutate(date = date(invoice_date), #adds in the full date, strips time
         month = month(invoice_date), ## adds invoice month
         day = day(invoice_date), ## adds invoice day in month (1-31)
         weekday = wday(invoice_date), ## adds invoice weekday (1-7) need to find if they start week on monday or sunday
         hour = hour(invoice_date)) %&amp;gt;%  ## adds invoice hour
    ungroup() %&amp;gt;%
    filter(!str_detect(description, &amp;quot;^[:lower:]+$&amp;quot;))## Found a bunch of item descriptions that seemed to be one off descriptions like &amp;quot;damaged&amp;quot;, &amp;quot;broken&amp;quot; etc.. This function removes those from the data set.

skimr::skim(sales)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-4&#34;&gt;Table 2: &lt;/span&gt;Data summary&lt;/caption&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Name&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;sales&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Number of rows&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;540118&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Number of columns&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;15&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;_______________________&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Column type frequency:&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Date&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;factor&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;numeric&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;9&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;POSIXct&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;________________________&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Group variables&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;None&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Variable type: Date&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;skim_variable&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_missing&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;complete_rate&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;min&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;max&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;median&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_unique&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;date&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2010-12-01&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2011-12-09&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2011-07-20&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;305&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Variable type: factor&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;skim_variable&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_missing&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;complete_rate&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;ordered&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_unique&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;top_counts&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;invoice_no&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;FALSE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24109&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;573: 1114, 581: 749, 581: 731, 580: 721&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;stock_code&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;FALSE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3954&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;851: 2313, 224: 2200, 850: 2159, 475: 1727&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;description&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;FALSE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4186&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;WHI: 2369, REG: 2200, JUM: 2159, PAR: 1727&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;country&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;FALSE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;38&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Uni: 493687, Ger: 9495, Fra: 8557, EIR: 8196&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Variable type: numeric&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;colgroup&gt;
&lt;col width=&#34;13%&#34; /&gt;
&lt;col width=&#34;6%&#34; /&gt;
&lt;col width=&#34;9%&#34; /&gt;
&lt;col width=&#34;6%&#34; /&gt;
&lt;col width=&#34;5%&#34; /&gt;
&lt;col width=&#34;7%&#34; /&gt;
&lt;col width=&#34;6%&#34; /&gt;
&lt;col width=&#34;6%&#34; /&gt;
&lt;col width=&#34;6%&#34; /&gt;
&lt;col width=&#34;6%&#34; /&gt;
&lt;col width=&#34;27%&#34; /&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;skim_variable&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_missing&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;complete_rate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;mean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;sd&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p0&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p25&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p50&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p75&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p100&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;hist&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;quantity&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.64&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;218.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-80995.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;80995.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▁▁▇▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;unit_price&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.63&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;96.92&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-11062.06&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.25&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.08&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.13&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;38970.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▁▇▁▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;customer_id&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;133289&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.75&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15287.69&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1713.60&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12346.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13953.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15152.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16791.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18287.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▇▇▇▇▇&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;item_value&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.05&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;379.44&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-168469.60&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.48&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.84&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17.40&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;168469.6&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▁▁▇▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;invoice_total_value&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1343.76&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2372.20&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-168469.60&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;288.99&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;517.05&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1436.93&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;168469.6&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▁▁▇▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;month&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7.56&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.51&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▃▂▃▃▇&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;day&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.02&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.66&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;22.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;31.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▇▆▆▆▅&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;weekday&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.60&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.61&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▇▅▅▅▅&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;hour&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13.08&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.44&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▁▅▇▆▁&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Variable type: POSIXct&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;colgroup&gt;
&lt;col width=&#34;13%&#34; /&gt;
&lt;col width=&#34;9%&#34; /&gt;
&lt;col width=&#34;13%&#34; /&gt;
&lt;col width=&#34;18%&#34; /&gt;
&lt;col width=&#34;18%&#34; /&gt;
&lt;col width=&#34;18%&#34; /&gt;
&lt;col width=&#34;8%&#34; /&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;skim_variable&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_missing&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;complete_rate&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;min&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;max&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;median&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_unique&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;invoice_date&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2010-12-01 08:26:00&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2011-12-09 12:50:00&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2011-07-20 11:22:00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;22050&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Looking at our new data frame, we have a lot more data to work with. We can now organize our data in so many different ways, such as hour of day, or day of the week. Speaking of day of the week, It looks like we only have sales day for day 6. Meaning that sales are not processed one day out of the week. We need to know whether Sunday or Monday equates to day 1 of 7.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sales %&amp;gt;% 
  filter(date == &amp;quot;2010-12-01&amp;quot;) %&amp;gt;% 
  select(date, weekday)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 3,098 x 2
##    date       weekday
##    &amp;lt;date&amp;gt;       &amp;lt;dbl&amp;gt;
##  1 2010-12-01       4
##  2 2010-12-01       4
##  3 2010-12-01       4
##  4 2010-12-01       4
##  5 2010-12-01       4
##  6 2010-12-01       4
##  7 2010-12-01       4
##  8 2010-12-01       4
##  9 2010-12-01       4
## 10 2010-12-01       4
## # ... with 3,088 more rows&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Going back in the calendar, we know that December 1st 2020, starts on a Wednesday. This means that our week starts on Sunday, and by extension, that our store does not process sales on Saturday.&lt;/p&gt;
&lt;p&gt;With our data in a more usable format, and some extra variables added, we can start our exploratory data analysis.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;exploratory-data-analysis&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Exploratory Data Analysis&lt;/h1&gt;
&lt;div id=&#34;sales-over-time&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Sales Over Time&lt;/h2&gt;
&lt;p&gt;First and foremost, let’s look at the sales over the year. Let’s see if anything stands out right off the top before we get into the nitty gritty.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sales %&amp;gt;% 
  group_by(date) %&amp;gt;% 
  summarise(total = sum(invoice_total_value)) %&amp;gt;% 
  mutate(flag = ifelse(total &amp;gt;= 8000000, T, F)) %&amp;gt;% 
  ggplot(aes(date, total)) +
  geom_col(aes(fill = flag)) +
  scale_y_continuous(labels = scales::dollar_format()) + 
  scale_fill_manual(values = c(&amp;#39;#595959&amp;#39;, &amp;#39;red&amp;#39;))+
  scale_x_date(date_breaks = &amp;quot;months&amp;quot; , date_labels = &amp;quot;%b-%y&amp;quot;)+
  theme_minimal()+
  theme(text = element_text(family = &amp;quot;Nunito Bold&amp;quot;, face = &amp;quot;bold&amp;quot;),
    legend.position = &amp;quot;none&amp;quot;,
    panel.grid.major.x  = element_blank(),
    panel.grid.minor.x = element_blank()
  )+
  labs(
    title = &amp;quot;Total Sales by Date&amp;quot;,
    x = &amp;quot;&amp;quot;,
    y = &amp;quot;&amp;quot;
  )&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-09-27-customer-analysis-eda.en_files/figure-html/unnamed-chunk-6-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;We’re looking at a graph of total sales over the year. We’ve highlighted total sales per day over $8,000,000. We see a large number of these days in December in both 2010 and 2011. We can assume that December is a big month for this company. We also see a day in August that exceeded $8,000,000. Let’s take a look at that day and see if anything sticks out.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sales %&amp;gt;% 
  filter(month == 8) %&amp;gt;% 
  group_by(date) %&amp;gt;% 
  summarise(total = sum(invoice_total_value)) %&amp;gt;% 
  filter(total &amp;gt;= 8000000)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 1 x 2
##   date          total
##   &amp;lt;date&amp;gt;        &amp;lt;dbl&amp;gt;
## 1 2011-08-11 9209482.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;August 11th, 2011 had a total sales of 9.2 million. Let’s dive in and see if any orders stand out.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sales %&amp;gt;% 
  filter(date == &amp;quot;2011-08-11&amp;quot;) %&amp;gt;% 
  group_by(invoice_no) %&amp;gt;% 
  summarize(total = sum(invoice_total_value)) %&amp;gt;% 
  arrange(-total) %&amp;gt;% 
  head(20) %&amp;gt;% 
  knitr::kable()&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;invoice_no&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;total&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;562955&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5887072.78&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;563076&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2278928.54&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;563074&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;205693.84&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;563093&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;200606.56&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;562980&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;130418.40&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;563016&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;34799.80&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;562949&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;32643.02&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;563094&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;28079.52&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;562984&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24586.05&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;562939&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23787.36&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;562965&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;22004.40&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;563022&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21986.85&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;562964&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19270.80&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;563061&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16496.20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;563023&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16030.20&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;563017&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15675.52&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;563020&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14523.36&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;563019&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14297.28&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;563037&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14077.50&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;563012&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13375.53&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;We’ve got two invoices well over $200,000. Let’s examine those a little bit.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sales %&amp;gt;% 
  filter(invoice_no == 562955) %&amp;gt;% 
  head(5) %&amp;gt;% 
  select(-c(invoice_date, day, month, weekday, hour)) %&amp;gt;% 
  knitr::kable()&lt;/code&gt;&lt;/pre&gt;
&lt;table style=&#34;width:100%;&#34;&gt;
&lt;colgroup&gt;
&lt;col width=&#34;7%&#34; /&gt;
&lt;col width=&#34;7%&#34; /&gt;
&lt;col width=&#34;23%&#34; /&gt;
&lt;col width=&#34;6%&#34; /&gt;
&lt;col width=&#34;7%&#34; /&gt;
&lt;col width=&#34;8%&#34; /&gt;
&lt;col width=&#34;10%&#34; /&gt;
&lt;col width=&#34;7%&#34; /&gt;
&lt;col width=&#34;13%&#34; /&gt;
&lt;col width=&#34;7%&#34; /&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;invoice_no&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;stock_code&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;description&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;quantity&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;unit_price&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;customer_id&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;country&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;item_value&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;invoice_total_value&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;date&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;562955&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;22469&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;HEART OF WICKER SMALL&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.13&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;United Kingdom&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16.52&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16677.26&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2011-08-11&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;562955&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;22470&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;HEART OF WICKER LARGE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.79&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;United Kingdom&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23.16&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16677.26&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2011-08-11&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;562955&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;22485&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;SET OF 2 WOODEN MARKET CRATES&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24.96&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;United Kingdom&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;74.88&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16677.26&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2011-08-11&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;562955&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;22488&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;NATURAL SLATE RECTANGLE CHALKBOARD&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.29&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;United Kingdom&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;29.61&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16677.26&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2011-08-11&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;562955&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;22501&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;PICNIC BASKET WICKER LARGE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20.79&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;United Kingdom&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;311.85&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16677.26&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2011-08-11&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Well this first order, we don’t have a customer ID. It would be worth while to find who created this invoice, so we can execute targeted marketing for future repurchases!&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sales %&amp;gt;% 
  filter(invoice_no == 563076) %&amp;gt;% 
  head(5) %&amp;gt;% 
  select(-c(invoice_date, day, month, weekday, hour)) %&amp;gt;% 
  knitr::kable()&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;colgroup&gt;
&lt;col width=&#34;7%&#34; /&gt;
&lt;col width=&#34;7%&#34; /&gt;
&lt;col width=&#34;25%&#34; /&gt;
&lt;col width=&#34;6%&#34; /&gt;
&lt;col width=&#34;7%&#34; /&gt;
&lt;col width=&#34;8%&#34; /&gt;
&lt;col width=&#34;8%&#34; /&gt;
&lt;col width=&#34;7%&#34; /&gt;
&lt;col width=&#34;13%&#34; /&gt;
&lt;col width=&#34;7%&#34; /&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;invoice_no&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;stock_code&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;description&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;quantity&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;unit_price&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;customer_id&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;country&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;item_value&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;invoice_total_value&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;date&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;563076&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;22795&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;SWEETHEART RECIPE BOOK STAND&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.95&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14646&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Netherlands&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;95.20&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19150.66&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2011-08-11&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;563076&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;23176&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ABC TREASURE BOOK BOX&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;72&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.95&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14646&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Netherlands&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;140.40&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19150.66&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2011-08-11&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;563076&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;22399&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;MAGNETS PACK OF 4 CHILDHOOD MEMORY&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;108&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.06&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14646&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Netherlands&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;114.48&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19150.66&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2011-08-11&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;563076&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;23268&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;SET OF 2 CERAMIC CHRISTMAS REINDEER&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;384&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.25&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14646&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Netherlands&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;480.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19150.66&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2011-08-11&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;563076&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;23270&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;SET OF 2 CERAMIC PAINTED HEARTS&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;192&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.25&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14646&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Netherlands&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;240.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19150.66&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2011-08-11&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;This is a big order out of the Netherlands that we do actually have a customer ID for. When we do our analysis on where our buying comes from, we should pay attention to the Netherlands. Perhaps this one buyer makes up a large portion of that countries total buying.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;unit-drivers&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Unit Drivers&lt;/h2&gt;
&lt;p&gt;Let’s identify the largest unit drivers over the year. When we look at the data set, when we look at item descriptions with 1 or 2 units, they seem to be either 1 off or just data entry errors. We could process these out, but for the sake of this exercise, I’m going to filter to items that have a total unit value of at least 3.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;unit_drivers &amp;lt;- sales %&amp;gt;% 
  select(description, quantity) %&amp;gt;% 
  group_by(description) %&amp;gt;% 
  summarise(total_quantity = sum(quantity)) %&amp;gt;% 
  filter(total_quantity &amp;gt;3) %&amp;gt;% 
  ungroup() %&amp;gt;% 
  arrange(desc(total_quantity)) %&amp;gt;% 
  head(20)


unit_drivers %&amp;gt;% 
  ggplot(aes(fct_reorder(description, total_quantity), total_quantity, label = total_quantity)) + 
  geom_col(fill = &amp;quot;#303844&amp;quot;)+
  geom_text(hjust = 1.1, color = &amp;quot;white&amp;quot;,fontface = &amp;quot;bold&amp;quot;)+
  coord_flip()+
  theme_minimal()+
  theme(text = element_text(family = &amp;quot;Nunito Bold&amp;quot;, face = &amp;quot;bold&amp;quot;),
          axis.ticks = element_blank(),
          panel.grid = element_blank()
          )+
  labs(
    title = &amp;quot;Unit Drivers&amp;quot;,
    subtitle = &amp;quot;For Calendar Year 2011&amp;quot;,
    x = &amp;quot;&amp;quot;,
    y = &amp;quot;Units&amp;quot;
  ) -&amp;gt; graph_unit_drivers

graph_unit_drivers&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-09-27-customer-analysis-eda.en_files/figure-html/unnamed-chunk-11-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;We now have a graph of our top 20 unit drivers for the year 2011. If we can find inefficiencies in our sales process for these units, we can correct for them and increase our sales revenue due to the sheer volume of sales that these units produce.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;dollar-drivers&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Dollar Drivers&lt;/h2&gt;
&lt;p&gt;Let’s run the same type of analysis and identify our top dollar drivers.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;dollar_drivers &amp;lt;- sales %&amp;gt;% 
  select(description, invoice_total_value) %&amp;gt;% 
  group_by(description) %&amp;gt;% 
  summarise(total_dollars = sum(invoice_total_value)) %&amp;gt;% 
  ungroup() %&amp;gt;% 
  mutate(label_text = paste(&amp;quot;$&amp;quot;,round(total_dollars, digits = 2)),
         label_text = trimws(label_text))%&amp;gt;% 
  arrange(desc(total_dollars))%&amp;gt;% 
  head(20)

dollar_drivers %&amp;gt;% 
  ggplot(aes(fct_reorder(description, total_dollars), total_dollars, label = label_text)) + 
  geom_col(fill = &amp;quot;#303844&amp;quot;)+
  geom_text(hjust = 1.1, color = &amp;quot;white&amp;quot;,fontface = &amp;quot;bold&amp;quot;)+
  scale_y_continuous(labels=scales::dollar_format())+
  coord_flip()+
  theme_minimal()+
  theme(text = element_text(family = &amp;quot;Nunito Bold&amp;quot;, face = &amp;quot;bold&amp;quot;),
          axis.ticks = element_blank(),
          panel.grid = element_blank()
          )+
  labs(
    title = &amp;quot;Dollar Drivers&amp;quot;,
    subtitle = &amp;quot;For Calendar Year 2011&amp;quot;,
    x = &amp;quot;&amp;quot;,
    y = &amp;quot;&amp;quot;
  ) -&amp;gt; graph_dollar_drivers

graph_dollar_drivers&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-09-27-customer-analysis-eda.en_files/figure-html/unnamed-chunk-12-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Looking at the two graphs we can see that a few SKU’s show up in both the dollar drivers and the unit drivers. For instance the &lt;em&gt;Party Bunting&lt;/em&gt;, and the &lt;em&gt;Pack of 72 Retrospot Cake Cases&lt;/em&gt;. It is safe to say that these two SKU’s make up an important part of the business.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;where-in-the-world-are-our-sales&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Where in the World Are Our Sales?&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sales_by_country &amp;lt;- sales %&amp;gt;% 
  select(country, invoice_total_value) %&amp;gt;%
  group_by(country) %&amp;gt;% 
  summarise(total_sales_by_country = sum(invoice_total_value)) 


sales_by_country %&amp;gt;% 
  arrange(desc(total_sales_by_country)) %&amp;gt;% 
  gt() %&amp;gt;% 
  fmt_currency(
    # Define the columns to change
    columns = vars(total_sales_by_country),
    # How many decimals to round to
    decimals = 2,
  ) %&amp;gt;%
  # Align the now character column to be right-aligned
  cols_align(
    align = &amp;quot;right&amp;quot;,
    columns = vars(total_sales_by_country)) %&amp;gt;% 
  cols_label(
    total_sales_by_country = &amp;quot;Total Sales&amp;quot;,
    country = &amp;quot;Country&amp;quot;
  )  %&amp;gt;%
  tab_header(
    title = md(&amp;quot;**Sales by Country**&amp;quot;),
    subtitle = &amp;quot;2011&amp;quot;
  )&lt;/code&gt;&lt;/pre&gt;
&lt;style&gt;html {
  font-family: -apple-system, BlinkMacSystemFont, &#39;Segoe UI&#39;, Roboto, Oxygen, Ubuntu, Cantarell, &#39;Helvetica Neue&#39;, &#39;Fira Sans&#39;, &#39;Droid Sans&#39;, Arial, sans-serif;
}

#ilcbsqixtk .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ilcbsqixtk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ilcbsqixtk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ilcbsqixtk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ilcbsqixtk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ilcbsqixtk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ilcbsqixtk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ilcbsqixtk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ilcbsqixtk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ilcbsqixtk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ilcbsqixtk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ilcbsqixtk .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ilcbsqixtk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ilcbsqixtk .gt_from_md &gt; :first-child {
  margin-top: 0;
}

#ilcbsqixtk .gt_from_md &gt; :last-child {
  margin-bottom: 0;
}

#ilcbsqixtk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ilcbsqixtk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#ilcbsqixtk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ilcbsqixtk .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#ilcbsqixtk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ilcbsqixtk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ilcbsqixtk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ilcbsqixtk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ilcbsqixtk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ilcbsqixtk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#ilcbsqixtk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ilcbsqixtk .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#ilcbsqixtk .gt_left {
  text-align: left;
}

#ilcbsqixtk .gt_center {
  text-align: center;
}

#ilcbsqixtk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ilcbsqixtk .gt_font_normal {
  font-weight: normal;
}

#ilcbsqixtk .gt_font_bold {
  font-weight: bold;
}

#ilcbsqixtk .gt_font_italic {
  font-style: italic;
}

#ilcbsqixtk .gt_super {
  font-size: 65%;
}

#ilcbsqixtk .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
&lt;/style&gt;
&lt;div id=&#34;ilcbsqixtk&#34; style=&#34;overflow-x:auto;overflow-y:auto;width:auto;height:auto;&#34;&gt;&lt;table class=&#34;gt_table&#34;&gt;
  &lt;thead class=&#34;gt_header&#34;&gt;
    &lt;tr&gt;
      &lt;th colspan=&#34;2&#34; class=&#34;gt_heading gt_title gt_font_normal&#34; style&gt;&lt;strong&gt;Sales by Country&lt;/strong&gt;&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th colspan=&#34;2&#34; class=&#34;gt_heading gt_subtitle gt_font_normal gt_bottom_border&#34; style&gt;2011&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;thead class=&#34;gt_col_headings&#34;&gt;
    &lt;tr&gt;
      &lt;th class=&#34;gt_col_heading gt_columns_bottom_border gt_center&#34; rowspan=&#34;1&#34; colspan=&#34;1&#34;&gt;Country&lt;/th&gt;
      &lt;th class=&#34;gt_col_heading gt_columns_bottom_border gt_right&#34; rowspan=&#34;1&#34; colspan=&#34;1&#34;&gt;Total Sales&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody class=&#34;gt_table_body&#34;&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;United Kingdom&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$652,672,300.00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Netherlands&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$18,093,270.11&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Australia&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$10,524,587.39&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;EIRE&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$9,958,173.60&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Germany&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$7,728,452.33&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;France&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$7,332,944.50&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Switzerland&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$4,163,775.10&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Spain&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$2,172,299.21&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Norway&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$1,891,707.24&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Portugal&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$1,294,880.06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Belgium&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$1,179,874.95&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Japan&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$931,334.20&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Israel&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$905,426.91&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Channel Islands&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$858,722.68&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Cyprus&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$848,770.76&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Sweden&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$774,996.46&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Finland&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$735,092.37&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Italy&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$630,858.70&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Singapore&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$553,321.72&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Hong Kong&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$522,479.73&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Denmark&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$466,853.60&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Austria&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$307,311.71&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Unspecified&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$189,661.49&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Poland&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$168,920.07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Canada&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$163,279.88&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Greece&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$147,157.84&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Iceland&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$134,181.24&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Malta&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$87,997.60&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Lebanon&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$76,224.60&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;United Arab Emirates&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$62,809.68&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;RSA&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$58,133.98&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;USA&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$38,928.34&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Brazil&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$36,595.20&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Lithuania&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$32,208.50&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;European Community&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$29,123.05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Czech Republic&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$10,779.66&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Bahrain&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$6,328.20&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class=&#34;gt_row gt_center&#34;&gt;Saudi Arabia&lt;/td&gt;
      &lt;td class=&#34;gt_row gt_right&#34;&gt;$1,298.53&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
  
  
&lt;/table&gt;&lt;/div&gt;
&lt;p&gt;The vast, vast majority of the yearly sales came from the UK. Considering that this business is based there, that makes sense. Looking at our lowest value countries, We have Saudi Arabia, Bahrain and The Czech Republic. If there is marketing dollars being spent there currently, it may be wise to move it else where.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;wrap-up&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Wrap Up&lt;/h1&gt;
&lt;p&gt;We took a look at our sales data from this anonymized store data set. We look at unit drivers, dollar drivers and which countries produced the most sales. In the future it would be beneficial to examine customer segmentation, perhaps utilizing KNN. I will save that for a future blog post however.&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>European Energy (Tidy Tuesday)</title>
      <link>/post/european-energy-tidy-tuesday/</link>
      <pubDate>Sun, 09 Aug 2020 00:00:00 +0000</pubDate>
      <guid>/post/european-energy-tidy-tuesday/</guid>
      <description>


&lt;div id=&#34;library-and-data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Library and Data&lt;/h2&gt;
&lt;p&gt;Let’s load in our data and libraries. Our data comes from the &lt;a href=&#34;https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-08-04/readme.md&#34;&gt;European Energy Tidy Tuesday data set.&lt;/a&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(tidyverse)


energy_types &amp;lt;- readr::read_csv(&amp;#39;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-08-04/energy_types.csv&amp;#39;)
country_totals &amp;lt;- readr::read_csv(&amp;#39;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-08-04/country_totals.csv&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;quick-eda&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Quick EDA&lt;/h2&gt;
&lt;p&gt;Let’s take a quick look at our data.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;skimr::skim(energy_types)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-2&#34;&gt;Table 1: &lt;/span&gt;Data summary&lt;/caption&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Name&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;energy_types&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Number of rows&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;296&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Number of columns&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;_______________________&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Column type frequency:&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;character&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;numeric&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;________________________&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Group variables&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;None&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Variable type: character&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;skim_variable&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_missing&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;complete_rate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;min&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;max&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;empty&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_unique&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;whitespace&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;country&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;37&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;country_name&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.97&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;36&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;type&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;level&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Variable type: numeric&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;skim_variable&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_missing&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;complete_rate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;mean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;sd&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p0&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p25&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p50&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p75&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p100&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;hist&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2016&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12783.36&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;41066.36&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;373.28&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5677.25&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;390141.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▇▁▁▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2017&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12910.96&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;41029.50&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;351.89&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5924.46&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;379094.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▇▁▁▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2018&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12796.20&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;39423.36&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;278.35&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6790.15&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;393153.2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▇▁▁▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;In our &lt;code&gt;energy_types&lt;/code&gt; data set we’ve got 37 different countries, however we are missing 1 country name it seems. Let see which one is missing.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;energy_types %&amp;gt;% 
  filter(is.na(country_name))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 8 x 7
##   country country_name type                 level    `2016`  `2017`  `2018`
##   &amp;lt;chr&amp;gt;   &amp;lt;chr&amp;gt;        &amp;lt;chr&amp;gt;                &amp;lt;chr&amp;gt;     &amp;lt;dbl&amp;gt;   &amp;lt;dbl&amp;gt;   &amp;lt;dbl&amp;gt;
## 1 UK      &amp;lt;NA&amp;gt;         Conventional thermal Level 1 203165. 189297. 180838.
## 2 UK      &amp;lt;NA&amp;gt;         Nuclear              Level 1  65149.  63887.  59098.
## 3 UK      &amp;lt;NA&amp;gt;         Hydro                Level 1   8287.   8723.   7679.
## 4 UK      &amp;lt;NA&amp;gt;         Pumped hydro power   Level 2   2949.   2862.   2516.
## 5 UK      &amp;lt;NA&amp;gt;         Wind                 Level 1  37263.  50004.  56904.
## 6 UK      &amp;lt;NA&amp;gt;         Solar                Level 1  10411.  11525.  12857.
## 7 UK      &amp;lt;NA&amp;gt;         Geothermal           Level 1      0       0       0 
## 8 UK      &amp;lt;NA&amp;gt;         Other                Level 1      0       0       0&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The United Kingdom is our country name that is missing. Lets fix that.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;energy_types &amp;lt;- energy_types %&amp;gt;% 
  mutate(country_name = case_when(
    country == &amp;quot;UK&amp;quot; ~ &amp;quot;United Kingdom&amp;quot;,
    TRUE ~ country_name
  ))
    

skimr::skim(energy_types)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-4&#34;&gt;Table 2: &lt;/span&gt;Data summary&lt;/caption&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Name&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;energy_types&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Number of rows&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;296&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Number of columns&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;_______________________&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Column type frequency:&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;character&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;numeric&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;________________________&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Group variables&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;None&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Variable type: character&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;skim_variable&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_missing&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;complete_rate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;min&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;max&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;empty&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_unique&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;whitespace&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;country&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;37&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;country_name&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;37&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;type&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;level&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Variable type: numeric&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;skim_variable&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_missing&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;complete_rate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;mean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;sd&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p0&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p25&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p50&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p75&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p100&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;hist&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2016&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12783.36&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;41066.36&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;373.28&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5677.25&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;390141.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▇▁▁▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2017&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12910.96&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;41029.50&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;351.89&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5924.46&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;379094.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▇▁▁▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2018&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12796.20&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;39423.36&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;278.35&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6790.15&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;393153.2&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▇▁▁▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;We’ve now got a full data set for &lt;code&gt;energy_types&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Lets take a quick look at the &lt;code&gt;country_totals&lt;/code&gt; data set.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;skimr::skim(country_totals)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-5&#34;&gt;Table 3: &lt;/span&gt;Data summary&lt;/caption&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Name&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;country_totals&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Number of rows&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;185&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Number of columns&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;_______________________&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Column type frequency:&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;character&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;numeric&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;________________________&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Group variables&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;None&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Variable type: character&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;skim_variable&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_missing&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;complete_rate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;min&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;max&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;empty&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_unique&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;whitespace&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;country&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;37&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;country_name&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.97&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;36&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;type&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;26&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;level&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Variable type: numeric&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;skim_variable&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_missing&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;complete_rate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;mean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;sd&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p0&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p25&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p50&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p75&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p100&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;hist&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2016&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.99&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;45207.06&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;99814.70&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1620.50&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8426.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;29583.31&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;614155.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▇▁▁▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2017&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;45413.37&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;100337.16&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2204.74&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8189.7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;30676.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;619059.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▇▁▁▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2018&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;45062.34&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;98010.77&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2186.68&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8326.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;31671.10&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;571799.7&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▇▁▁▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;This time we have 5 &lt;code&gt;country_names&lt;/code&gt; missing from our data set. Lets fix that as well.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;country_totals %&amp;gt;% 
  filter(is.na(country_name))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 5 x 7
##   country country_name type                       level  `2016`  `2017`  `2018`
##   &amp;lt;chr&amp;gt;   &amp;lt;chr&amp;gt;        &amp;lt;chr&amp;gt;                      &amp;lt;chr&amp;gt;   &amp;lt;dbl&amp;gt;   &amp;lt;dbl&amp;gt;   &amp;lt;dbl&amp;gt;
## 1 UK      &amp;lt;NA&amp;gt;         Total net production       Total 324274. 323440. 317376.
## 2 UK      &amp;lt;NA&amp;gt;         Imports                    Total  20018.  18167.  21332.
## 3 UK      &amp;lt;NA&amp;gt;         Exports                    Total   2273.   3407.   2225.
## 4 UK      &amp;lt;NA&amp;gt;         Energy absorbed by pumping Total   4014.   3859.   3391.
## 5 UK      &amp;lt;NA&amp;gt;         Energy supplied            Total 338005. 334340. 333092.&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;country_totals &amp;lt;- country_totals %&amp;gt;% 
  mutate(country_name = case_when(
    country == &amp;quot;UK&amp;quot; ~ &amp;quot;United Kingdom&amp;quot;,
    TRUE ~ country_name
  ))


skimr::skim(country_totals)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-6&#34;&gt;Table 4: &lt;/span&gt;Data summary&lt;/caption&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Name&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;country_totals&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Number of rows&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;185&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Number of columns&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;7&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;_______________________&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Column type frequency:&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;character&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;numeric&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;________________________&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Group variables&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;None&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Variable type: character&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;skim_variable&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_missing&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;complete_rate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;min&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;max&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;empty&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_unique&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;whitespace&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;country&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;37&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;country_name&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;37&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;type&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;26&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;level&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Variable type: numeric&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;skim_variable&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n_missing&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;complete_rate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;mean&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;sd&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p0&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p25&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p50&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p75&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p100&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;hist&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2016&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.99&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;45207.06&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;99814.70&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1620.50&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8426.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;29583.31&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;614155.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▇▁▁▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2017&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;45413.37&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;100337.16&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2204.74&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8189.7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;30676.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;619059.0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▇▁▁▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;2018&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;45062.34&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;98010.77&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2186.68&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8326.0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;31671.10&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;571799.7&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;▇▁▁▁▁&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Now that we have our &lt;code&gt;country_names&lt;/code&gt; updated. Lets actually take a look and see what is contained within our data sets.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;country_totals %&amp;gt;% 
  head(10) %&amp;gt;% 
  knitr::kable()&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;country&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;country_name&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;type&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;level&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;2016&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;2017&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;2018&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Belgium&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Total net production&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Total&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;82520&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;82948.500&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;69212.347&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Belgium&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Imports&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Total&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14648&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14189.400&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21635.908&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Belgium&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Exports&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Total&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8465&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8167.800&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4308.347&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Belgium&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Energy absorbed by pumping&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Total&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1475&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1485.400&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1347.901&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Belgium&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Energy supplied&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Total&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;87228&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;87484.700&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;85192.007&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BG&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Bulgaria&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Total net production&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Total&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;41221&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;41351.303&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;41705.000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BG&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Bulgaria&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Imports&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Total&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4568&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3705.423&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2223.000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BG&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Bulgaria&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Exports&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Total&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10940&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9185.794&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10030.000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BG&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Bulgaria&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Energy absorbed by pumping&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Total&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;918&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;949.527&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;425.000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BG&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Bulgaria&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Energy supplied&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Total&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;33931&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;34921.405&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;33473.000&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;energy_types %&amp;gt;% 
  head(10) %&amp;gt;% 
  knitr::kable()&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;country&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;country_name&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;type&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;level&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;2016&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;2017&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;2018&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Belgium&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Conventional thermal&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Level 1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;30728&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;31316.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;30092.635&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Belgium&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Nuclear&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Level 1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;41430&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;40128.50&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;26995.628&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Belgium&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Hydro&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Level 1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1476&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1360.90&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1239.248&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Belgium&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Pumped hydro power&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Level 2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1110&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1093.20&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;983.190&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Belgium&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Wind&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Level 1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5340&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6387.90&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7177.346&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Belgium&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Solar&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Level 1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3070&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3264.30&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3488.979&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Belgium&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Geothermal&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Level 1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Belgium&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Other&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Level 1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;476&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;490.90&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;218.509&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BG&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Bulgaria&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Conventional thermal&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Level 1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18909&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20234.21&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19334.000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BG&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Bulgaria&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Nuclear&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Level 1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14932&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14718.37&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15290.000&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Looking at our &lt;code&gt;country_totals&lt;/code&gt; data set, it looks like we have a summary of a country’s energy export/import. Where as the &lt;code&gt;energy_types&lt;/code&gt; data set contains a breakdown of a country actual energy use by type. Looking at the &lt;code&gt;levels&lt;/code&gt; vector, we have a &lt;code&gt;Level 2&lt;/code&gt; level. A tweet from Tom Mock outlines that we do not need to factor this into our data, as it is a subset of &lt;code&gt;hydro&lt;/code&gt;. &lt;a href=&#34;https://twitter.com/thomas_mock/status/1290771994192023554&#34;&gt;This means to include it would be to double count &lt;code&gt;hydro&lt;/code&gt;.&lt;/a&gt; We can filter these entries out. Our raw energy totals are in &lt;a href=&#34;https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-08-04/readme.md&#34;&gt;Gigawatt Hours&lt;/a&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;energy_type_l2 &amp;lt;- energy_types %&amp;gt;% 
  filter(level != &amp;quot;Level 2&amp;quot;) &lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;visualization&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Visualization&lt;/h2&gt;
&lt;p&gt;I want visualize a breakdown of each country’s energy use by production method for the year of 2018. Lets see what we can come up with.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;energy_type_l2 %&amp;gt;% 
  select(-c(`2016`,`2017`)) %&amp;gt;% 
  ggplot(aes(country_name, `2018`, fill = type))+ #try and get a reorder
  geom_col()+
  coord_flip() -&amp;gt;p_0


p_0&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-08-09-european-energy-tidy-tuesday_files/figure-html/unnamed-chunk-9-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;This first plot is nice but it’s hard to compare between countries. We need to reorder our country name somehow. Let add together the total energy usage by &lt;code&gt;type&lt;/code&gt; to see how much total energy each country used and use that to order our plot.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;energy_total &amp;lt;- energy_type_l2 %&amp;gt;% 
  select(-c(`2016`, `2017`)) %&amp;gt;% 
  group_by(country_name) %&amp;gt;% 
  mutate(
    energy_total = sum(`2018`)/1000,
    `2018` = `2018`/1000
    
  )

energy_total&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 259 x 6
## # Groups:   country_name [37]
##    country country_name type                 level   `2018` energy_total
##    &amp;lt;chr&amp;gt;   &amp;lt;chr&amp;gt;        &amp;lt;chr&amp;gt;                &amp;lt;chr&amp;gt;    &amp;lt;dbl&amp;gt;        &amp;lt;dbl&amp;gt;
##  1 BE      Belgium      Conventional thermal Level 1 30.1           69.2
##  2 BE      Belgium      Nuclear              Level 1 27.0           69.2
##  3 BE      Belgium      Hydro                Level 1  1.24          69.2
##  4 BE      Belgium      Wind                 Level 1  7.18          69.2
##  5 BE      Belgium      Solar                Level 1  3.49          69.2
##  6 BE      Belgium      Geothermal           Level 1  0             69.2
##  7 BE      Belgium      Other                Level 1  0.219         69.2
##  8 BG      Bulgaria     Conventional thermal Level 1 19.3           41.7
##  9 BG      Bulgaria     Nuclear              Level 1 15.3           41.7
## 10 BG      Bulgaria     Hydro                Level 1  4.69          41.7
## # ... with 249 more rows&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now lets try making our graph again.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;energy_total %&amp;gt;% 
  ggplot(aes(fct_reorder(country_name, energy_total), `2018`, fill = type))+
  geom_col()+
  theme(
    #axis.title.x = element_blank(),
    axis.title.y = element_blank()
  )+
  labs(
    fill = &amp;quot;Total Energy Consumption by Production Method
(Per 1000 Gigawatts)&amp;quot;)+
  coord_flip() -&amp;gt; p_1

p_1&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-08-09-european-energy-tidy-tuesday_files/figure-html/unnamed-chunk-11-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;This is a lot easier to read! We can see how Germany France and the U.K. are Europe’s largest consumer of energy. However this also makes it difficult to compare the largest energy consumers to the smallest. Let’s see if we can look at the proportion of energy used by each instead. We start by building a proportion column.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;energy_prop &amp;lt;- energy_total %&amp;gt;% 
  group_by(country) %&amp;gt;% 
  mutate(
    prop = `2018`/energy_total
  )&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We now have a proportion of energy consumption by type that we can use to compare each country. Lets take a look.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;energy_prop %&amp;gt;% 
  ggplot(aes(country_name, prop , fill = type))+
  geom_col()+
  coord_flip()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-08-09-european-energy-tidy-tuesday_files/figure-html/unnamed-chunk-13-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;This is cool, we have a way to compare countries in their energy use. For instance on the bottom, we can see that Albania uses nearly all &lt;code&gt;hyrdo&lt;/code&gt; power as their many energy source. Lets put them in order of their total energy consumption so that we can reference total energy to their proportion of use.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;energy_prop %&amp;gt;% 
  ggplot(aes(fct_reorder(country_name, energy_total), prop, fill = type))+
  geom_col()+
 # scale_y_continuous(labels = scales::percent)+
  coord_flip() +
    theme(
    #axis.title.x = element_blank(),
    axis.title.y = element_blank()
  )+
  labs(
    y = &amp;quot;% of Energy Consumption by Production Method&amp;quot;
  ) -&amp;gt; p_2

p_2&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-08-09-european-energy-tidy-tuesday_files/figure-html/unnamed-chunk-14-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Now that we have our two plots in the same order, lets take a look at them side by side.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot_joined &amp;lt;-  cowplot::plot_grid(p_1, p_2, cols = 2)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot_joined &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-08-09-european-energy-tidy-tuesday_files/figure-html/unnamed-chunk-17-1.png&#34; width=&#34;1087.296&#34; /&gt;&lt;/p&gt;
&lt;p&gt;This is a super neat plot. Some insights provided by this graph:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Germany, The Netherlands and Poland still have work to do in terms of their conventional energy use.&lt;/li&gt;
&lt;li&gt;France is the largest user of nuclear energy in both absolute and relative terms.&lt;/li&gt;
&lt;li&gt;Norway and Albania both receive over 95% of their energy from hydro power&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>
